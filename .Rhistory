rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
library(dpfa)
array(1,c(3,3,3))
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
dpfa.out$phi_est
phi_tru
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=100,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
dpfa.out$phi_est
phi_tru
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
dpfa.out$phi_est
phi_tru
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=5,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
dpfa.out$phi_est
phi_tru
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=100,
bias_init=5,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
dpfa.out$phi_est
phi_tru
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=100,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
dpfa.out$phi_est
phi_tru
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=100,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
dpfa.out$phi_est
phi_tru
round(dpfa.out$phi_est,2)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
phi_tru
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=10,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
phi_tru
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=10,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=100,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
phi_tru
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
library(dpfa)
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
t(h_tru)[1:30,]
t(theta_tru)[1:30,]
C_kn <- dpfa:::calcC_kn(Theta_3D, rep(1,K), Theta_3D, phi_tru)
C_kn = matrix(C_kn, nrow=K,byrow=F) # was byrow=F
C_kn[,1:30]
C_kn = matrix(NA,K,ncol(h_tru))
for(i in 1:ncol(h_tru)){
for(k in 1:K){
C_kn[k,i] = rztpois(1,phi_tru[k,] %*% theta_tru[,i]) # not sure if this is the right truncated poisson
}
}
C_kn = matrix(NA,K,ncol(h_tru))
for(i in 1:ncol(h_tru)){
for(k in 1:K){
C_kn[k,i] = rpois(1,phi_tru[k,] %*% theta_tru[,i]) # not sure if this is the right truncated poisson
}
}
C_kn[,1:30]
library(dpfa)
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
phi_tru
cor(t(h_tru))
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=100,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
phi_tru
cor(t(theta_tru))
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=100,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
phi_tru
warnings()
library(dpfa)
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=1,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
phi_tru
# using true H still gives wrong Phi
# using true Phi gives wrong H  --- both seem to be the problem
dpfa.out = dpfa_noW(data,
K=3,
N=30,
M=15,
alpha_phi=.1,
numTime=100,
niter=10,
bias_init=1,
rk_init=1,
p0=.5,
init_con_H=1,
# W_true=w_tru)
H_true=h_tru,
theta_true=theta_tru,
phi_true=phi_tru,
psi_true=psi_tru)
round(dpfa.out$phi_est,2)
phi_tru
